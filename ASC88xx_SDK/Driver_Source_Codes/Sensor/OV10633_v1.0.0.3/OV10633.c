/*
 * OV10633
 * Driver for OV10633 sensor.
 *
 * Copyright (C) 2010  VN Inc.
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation; either version 2 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program; if not, write to the Free Software
 * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA 
 *
 */

#include <linux/kernel.h>
#include <linux/module.h>
#include <linux/fs.h>
#include <linux/slab.h>
#include <linux/version.h>

#include <asm/io.h>
#include <asm/uaccess.h>
#include <linux/delay.h>

#include "OV10633.h"
#include "OV10633_locals.h"
#include "IICCtrl.h"
#include <linux/semaphore.h> // sem_init(), up(), down_interruptibal()

const CHAR OV10633_ID[] = "$Version: "OV10633_ID_VERSION"  (OV10633 DRIVER) $";
	
static struct semaphore OV10633_mutex;

static TOV10633Info *ptInfo;
TVideoSensorDevice sensor_dev_ops;

MODULE_AUTHOR("VN Inc.");
MODULE_DESCRIPTION("OV10633 driver");
MODULE_LICENSE("GPL");

/*==================================================================*/
const TOV10633RegAddrData atOV10633WDRregTbl[OV10633WDR_TBL_SIZE] =
{
	{0x0103, 0x01},
	{0x301b, 0xff},
	{0x301c, 0xff},
	{0x301a, 0xff},
	{0x300c, 0x61},
	{0x300c, 0x61},
	{0x300c, 0x61},
	{0x300c, 0x61},
	{0x300c, 0x61},
	{0x300c, 0x61},
	{0x300c, 0x61},
	{0x300c, 0x61},
	{0x300c, 0x61},
	{0x300c, 0x61},
	{0x300c, 0x61},
	{0x300c, 0x61},
	{0x300c, 0x61},
	{0x300c, 0x61},
	{0x300c, 0x61},
	{0x300c, 0x61},
	{0x300c, 0x61},
	{0x300c, 0x61},
	{0x300c, 0x61},
	{0x300c, 0x61},
	{0x300c, 0x61},
	{0x300c, 0x61},
	{0x300c, 0x61},
	{0x3021, 0x03},
	{0x3011, 0x02},
	{0x6900, 0x0c},
	{0x6901, 0x01},
	{0x3033, 0x08},
	{0x3503, 0x10},
	{0x302d, 0x2f},
	{0x3025, 0x03},
	{0x3003, 0x20},
	{0x3004, 0x23},
	{0x3005, 0x20},
	{0x3006, 0x91},
	{0x3600, 0x74},
	{0x3601, 0x2b},
	{0x3612, 0x00},
	{0x3611, 0x67},
	{0x3633, 0xba},
	{0x3602, 0x2f},
	{0x3603, 0x00},
	{0x3630, 0xa8},
	{0x3631, 0x16},
	{0x3714, 0x10},
	{0x371d, 0x01},
	{0x4300, 0x3A},
	{0x3007, 0x01},
	{0x3024, 0x01},
	{0x3020, 0x0b},
	{0x3702, 0x10},
	{0x3703, 0x24},
	{0x3704, 0x19},
	{0x3709, 0x28},
	{0x370d, 0x00},
	{0x3712, 0x00},
	{0x3713, 0x20},
	{0x3715, 0x04},
	{0x381d, 0x40},
	{0x381c, 0x00},
	{0x3824, 0x10},
	{0x3815, 0x8c},
	{0x3804, 0x05},
	{0x3805, 0x1f},
	{0x3800, 0x00},
	{0x3801, 0x00},
	{0x3806, 0x03},
	{0x3807, 0x29},
	{0x3802, 0x00},
	{0x3803, 0x06},
	{0x3808, 0x05},
	{0x3809, 0x00},
	{0x380a, 0x03},
	{0x380b, 0x20},
	{0x380c, 0x07},
	{0x380d, 0x71},
	{0x380e, 0x03},
	{0x380f, 0x48},
	{0x3811, 0x08},
	{0x381f, 0x0c},
	{0x3621, 0x63},
	{0x5005, 0x08},
	{0x56d5, 0x00},
	{0x56d6, 0x80},
	{0x56d7, 0x00},
	{0x56d8, 0x00},
	{0x56d9, 0x00},
	{0x56da, 0x80},
	{0x56db, 0x00},
	{0x56dc, 0x00},
	{0x56e8, 0x00},
	{0x56e9, 0x7f},
	{0x56ea, 0x00},
	{0x56eb, 0x7f},
	{0x5100, 0x00},
	{0x5101, 0x80},
	{0x5102, 0x00},
	{0x5103, 0x80},
	{0x5104, 0x00},
	{0x5105, 0x80},
	{0x5106, 0x00},
	{0x5107, 0x80},
	{0x5108, 0x00},
	{0x5109, 0x00},
	{0x510a, 0x00},
	{0x510b, 0x00},
	{0x510c, 0x00},
	{0x510d, 0x00},
	{0x510e, 0x00},
	{0x510f, 0x00},
	{0x5110, 0x00},
	{0x5111, 0x80},
	{0x5112, 0x00},
	{0x5113, 0x80},
	{0x5114, 0x00},
	{0x5115, 0x80},
	{0x5116, 0x00},
	{0x5117, 0x80},
	{0x5118, 0x00},
	{0x5119, 0x00},
	{0x511a, 0x00},
	{0x511b, 0x00},
	{0x511c, 0x00},
	{0x511d, 0x00},
	{0x511e, 0x00},
	{0x511f, 0x00},
	{0x56d0, 0x00},
	{0x5006, 0x24},
	{0x5608, 0x00},
	{0x52d7, 0x06},
	{0x528d, 0x08},
	{0x5293, 0x12},
	{0x52d3, 0x12},
	{0x5288, 0x06},
	{0x5289, 0x20},
	{0x52c8, 0x06},
	{0x52c9, 0x20},
	{0x52cd, 0x04},
	{0x5381, 0x00},
	{0x5382, 0xff},
	{0x5589, 0x76},
	{0x558a, 0x47},
	{0x558b, 0xef},
	{0x558c, 0xc9},
	{0x558d, 0x49},
	{0x558e, 0x30},
	{0x558f, 0x67},
	{0x5590, 0x3f},
	{0x5591, 0xf0},
	{0x5592, 0x10},
	{0x55a2, 0x6d},
	{0x55a3, 0x55},
	{0x55a4, 0xc3},
	{0x55a5, 0xb5},
	{0x55a6, 0x43},
	{0x55a7, 0x38},
	{0x55a8, 0x5f},
	{0x55a9, 0x4b},
	{0x55aa, 0xf0},
	{0x55ab, 0x10},
	{0x5581, 0x52},
	{0x5300, 0x01},
	{0x5301, 0x00},
	{0x5302, 0x00},
	{0x5303, 0x0e},
	{0x5304, 0x00},
	{0x5305, 0x0e},
	{0x5306, 0x00},
	{0x5307, 0x36},
	{0x5308, 0x00},
	{0x5309, 0xd9},
	{0x530a, 0x00},
	{0x530b, 0x0f},
	{0x530c, 0x00},
	{0x530d, 0x2c},
	{0x530e, 0x00},
	{0x530f, 0x59},
	{0x5310, 0x00},
	{0x5311, 0x7b},
	{0x5312, 0x00},
	{0x5313, 0x22},
	{0x5314, 0x00},
	{0x5315, 0xd5},
	{0x5316, 0x00},
	{0x5317, 0x13},
	{0x5318, 0x00},
	{0x5319, 0x18},
	{0x531a, 0x00},
	{0x531b, 0x26},
	{0x531c, 0x00},
	{0x531d, 0xdc},
	{0x531e, 0x00},
	{0x531f, 0x02},
	{0x5320, 0x00},
	{0x5321, 0x24},
	{0x5322, 0x00},
	{0x5323, 0x56},
	{0x5324, 0x00},
	{0x5325, 0x85},
	{0x5326, 0x00},
	{0x5327, 0x20},
	{0x5609, 0x01},
	{0x560a, 0x40},
	{0x560b, 0x01},
	{0x560c, 0x40},
	{0x560d, 0x00},
	{0x560e, 0xfa},
	{0x560f, 0x00},
	{0x5610, 0xfa},
	{0x5611, 0x02},
	{0x5612, 0x80},
	{0x5613, 0x02},
	{0x5614, 0x80},
	{0x5615, 0x01},
	{0x5616, 0x2c},
	{0x5617, 0x01},
	{0x5618, 0x2c},
	{0x563b, 0x01},
	{0x563c, 0x01},
	{0x563d, 0x01},
	{0x563e, 0x01},
	{0x563f, 0x03},
	{0x5640, 0x03},
	{0x5641, 0x03},
	{0x5642, 0x05},
	{0x5643, 0x09},
	{0x5644, 0x05},
	{0x5645, 0x05},
	{0x5646, 0x05},
	{0x5647, 0x05},
	{0x5651, 0x00},
	{0x5652, 0x80},
	{0x521a, 0x01},
	{0x521b, 0x03},
	{0x521c, 0x06},
	{0x521d, 0x0a},
	{0x521e, 0x0e},
	{0x521f, 0x12},
	{0x5220, 0x16},
	{0x5223, 0x02},
	{0x5225, 0x04},
	{0x5227, 0x08},
	{0x5229, 0x0c},
	{0x522b, 0x12},
	{0x522d, 0x18},
	{0x522f, 0x1e},
	{0x5241, 0x04},
	{0x5242, 0x01},
	{0x5243, 0x03},
	{0x5244, 0x06},
	{0x5245, 0x0a},
	{0x5246, 0x0e},
	{0x5247, 0x12},
	{0x5248, 0x16},
	{0x524a, 0x03},
	{0x524c, 0x04},
	{0x524e, 0x08},
	{0x5250, 0x0c},
	{0x5252, 0x12},
	{0x5254, 0x18},
	{0x5256, 0x1e},
	{0x4605, 0x08},
	{0x4606, 0x07},
	{0x4607, 0x71},
	{0x460a, 0x02},
	{0x460b, 0x70},
	{0x460c, 0x00},
	{0x4620, 0x0e},
	{0x4700, 0x04},
	{0x4701, 0x00},
	{0x4702, 0x01},
	{0x4708, 0x03},
	{0x4004, 0x08},
	{0x4005, 0x18},
	{0x4001, 0x04},
	{0x4050, 0x20},
	{0x4051, 0x22},
	{0x4057, 0x9c},
	{0x405a, 0x00},
	{0x4202, 0x02},
	{0x3023, 0x10},
	{0x0100, 0x01},
	{0x0100, 0x01},
	{0x6f0e, 0x00},
	{0x6f0f, 0x00},
	{0x460e, 0x08},
	{0x460f, 0x01},
	{0x4610, 0x00},
	{0x4611, 0x01},
	{0x4612, 0x00},
	{0x4613, 0x01},
	{0x4605, 0x08},
	{0x4608, 0x00},
	{0x4609, 0x08},
	{0x6804, 0x00},
	{0x6805, 0x06},
	{0x6806, 0x00},
	{0x5120, 0x00},
	{0x3510, 0x00},
	{0x3504, 0x00},
	{0x6800, 0x00},
	{0x6f0d, 0x00},
	{0x5000, 0xff},
	{0x5001, 0xbf},
	{0x5002, 0xfe},
	{0x503d, 0x00},
	{0xc450, 0x01},
	{0xc452, 0x04},
	{0xc453, 0x00},
	{0xc454, 0x00},
	{0xc455, 0x00},
	{0xc456, 0x00},
	{0xc457, 0x00},
	{0xc458, 0x00},
	{0xc459, 0x00},
	{0xc45b, 0x00},
	{0xc45c, 0x00},
	{0xc45d, 0x00},
	{0xc45e, 0x00},
	{0xc45f, 0x00},
	{0xc460, 0x00},
	{0xc461, 0x01},
	{0xc462, 0x01},
	{0xc464, 0x88},
	{0xc465, 0x00},
	{0xc466, 0x8a},
	{0xc467, 0x00},
	{0xc468, 0x86},
	{0xc469, 0x00},
	{0xc46a, 0x40},
	{0xc46b, 0x50},
	{0xc46c, 0x30},
	{0xc46d, 0x28},
	{0xc46e, 0x60},
	{0xc46f, 0x40},
	{0xc47c, 0x01},
	{0xc47d, 0x38},
	{0xc47e, 0x00},
	{0xc47f, 0x00},
	{0xc480, 0x00},
	{0xc481, 0xff},
	{0xc482, 0x00},
	{0xc483, 0x40},
	{0xc484, 0x00},
	{0xc485, 0x18},
	{0xc486, 0x00},
	{0xc487, 0x18},
	{0xc488, 0x34},
	{0xc489, 0x00},
	{0xc48a, 0x34},
	{0xc48b, 0x00},
	{0xc48c, 0x00},
	{0xc48d, 0x04},
	{0xc48e, 0x00},
	{0xc48f, 0x04},
	{0xc490, 0x07},
	{0xc492, 0x20},
	{0xc493, 0x08},
	{0xc498, 0x02},
	{0xc499, 0x00},
	{0xc49a, 0x02},
	{0xc49b, 0x00},
	{0xc49c, 0x02},
	{0xc49d, 0x00},
	{0xc49e, 0x02},
	{0xc49f, 0x60},
	{0xc4a0, 0x04},
	{0xc4a1, 0x00},
	{0xc4a2, 0x06},
	{0xc4a3, 0x00},
	{0xc4a4, 0x00},
	{0xc4a5, 0x10},
	{0xc4a6, 0x00},
	{0xc4a7, 0x40},
	{0xc4a8, 0x00},
	{0xc4a9, 0x80},
	{0xc4aa, 0x0d},
	{0xc4ab, 0x00},
	{0xc4ac, 0x0f},
	{0xc4ad, 0xc0},
	{0xc4b4, 0x01},
	{0xc4b5, 0x01},
	{0xc4b6, 0x00},
	{0xc4b7, 0x01},
	{0xc4b8, 0x00},
	{0xc4b9, 0x01},
	{0xc4ba, 0x01},
	{0xc4bb, 0x00},
	{0xc4be, 0x02},
	{0xc4bf, 0x33},
	{0xc4c8, 0x03},
	{0xc4c9, 0xd0},
	{0xc4ca, 0x0e},
	{0xc4cb, 0x00},
	{0xc4cc, 0x10},
	{0xc4cd, 0x18},
	{0xc4ce, 0x10},
	{0xc4cf, 0x18},
	{0xc4d0, 0x04},
	{0xc4d1, 0x80},
	{0xc4e0, 0x04},
	{0xc4e1, 0x02},
	{0xc4e2, 0x01},
	{0xc4e4, 0x10},
	{0xc4e5, 0x20},
	{0xc4e6, 0x30},
	{0xc4e7, 0x40},
	{0xc4e8, 0x50},
	{0xc4e9, 0x60},
	{0xc4ea, 0x70},
	{0xc4eb, 0x80},
	{0xc4ec, 0x90},
	{0xc4ed, 0xa0},
	{0xc4ee, 0xb0},
	{0xc4ef, 0xc0},
	{0xc4f0, 0xd0},
	{0xc4f1, 0xe0},
	{0xc4f2, 0xf0},
	{0xc4f3, 0x80},
	{0xc4f4, 0x00},
	{0xc4f5, 0x20},
	{0xc4f6, 0x02},
	{0xc4f7, 0x00},
	{0xc4f8, 0x04},
	{0xc4f9, 0x0b},
	{0xc4fa, 0x00},
	{0xc4fb, 0x01},
	{0xc4fc, 0x01},
	{0xc4fd, 0x01},
	{0xc4fe, 0x04},
	{0xc4ff, 0x02},
	{0xc500, 0x68},
	{0xc501, 0x74},
	{0xc502, 0x70},
	{0xc503, 0x80},
	{0xc504, 0x05},
	{0xc505, 0x80},
	{0xc506, 0x03},
	{0xc507, 0x80},
	{0xc508, 0x01},
	{0xc509, 0xc0},
	{0xc50a, 0x01},
	{0xc50b, 0xa0},
	{0xc50c, 0x01},
	{0xc50d, 0x2c},
	{0xc50e, 0x01},
	{0xc50f, 0x0a},
	{0xc510, 0x00},
	{0xc511, 0x01},
	{0xc512, 0x01},
	{0xc513, 0x80},
	{0xc514, 0x04},
	{0xc515, 0x00},
	{0xc518, 0x03},
	{0xc519, 0x48},
	{0xc51a, 0x07},
	{0xc51b, 0x70},
	{0xc2e0, 0x00},
	{0xc2e1, 0x51},
	{0xc2e2, 0x00},
	{0xc2e3, 0xd6},
	{0xc2e4, 0x01},
	{0xc2e5, 0x5e},
	{0xc2e9, 0x01},
	{0xc2ea, 0x7a},
	{0xc2eb, 0x90},
	{0xc2ed, 0x00},
	{0xc2ee, 0x7a},
	{0xc2ef, 0x64},
	{0xc308, 0x00},
	{0xc309, 0x00},
	{0xc30a, 0x00},
	{0xc30c, 0x00},
	{0xc30d, 0x01},
	{0xc30e, 0x00},
	{0xc30f, 0x00},
	{0xc310, 0x01},
	{0xc311, 0x60},
	{0xc312, 0xff},
	{0xc313, 0x08},
	{0xc314, 0x01},
	{0xc315, 0x7f},
	{0xc316, 0xff},
	{0xc317, 0x0b},
	{0xc318, 0x00},
	{0xc319, 0x0c},
	{0xc31a, 0x00},
	{0xc31b, 0xe0},
	{0xc31c, 0x00},
	{0xc31d, 0x14},
	{0xc31e, 0x00},
	{0xc31f, 0xc5},
	{0xc320, 0xff},
	{0xc321, 0x4b},
	{0xc322, 0xff},
	{0xc323, 0xf0},
	{0xc324, 0xff},
	{0xc325, 0xe8},
	{0xc326, 0x00},
	{0xc327, 0x46},
	{0xc328, 0xff},
	{0xc329, 0xd2},
	{0xc32a, 0xff},
	{0xc32b, 0xe4},
	{0xc32c, 0xff},
	{0xc32d, 0xbb},
	{0xc32e, 0x00},
	{0xc32f, 0x61},
	{0xc330, 0xff},
	{0xc331, 0xf9},
	{0xc332, 0x00},
	{0xc333, 0xd9},
	{0xc334, 0x00},
	{0xc335, 0x2e},
	{0xc336, 0x00},
	{0xc337, 0xb1},
	{0xc338, 0xff},
	{0xc339, 0x64},
	{0xc33a, 0xff},
	{0xc33b, 0xeb},
	{0xc33c, 0xff},
	{0xc33d, 0xe8},
	{0xc33e, 0x00},
	{0xc33f, 0x48},
	{0xc340, 0xff},
	{0xc341, 0xd0},
	{0xc342, 0xff},
	{0xc343, 0xed},
	{0xc344, 0xff},
	{0xc345, 0xad},
	{0xc346, 0x00},
	{0xc347, 0x66},
	{0xc348, 0x01},
	{0xc349, 0x00},
	{0x6700, 0x08},
	{0x6701, 0x11},
	{0x6702, 0xfc},
	{0x6703, 0x9a},
	{0x6704, 0x3b},
	{0x6705, 0x65},
	{0x6706, 0x71},
	{0x6708, 0x05},
	{0x3822, 0x50},
	{0x6f06, 0x6f},
	{0x6f07, 0x00},
	{0x6f0a, 0x6f},
	{0x6f0b, 0x00},
	{0x6f00, 0x03},
	{0x3042, 0xf0},
	{0x3042, 0xf0},
	{0x3042, 0xf0},
	{0x3042, 0xf0},
	{0x3042, 0xf0},
	{0x3042, 0xf0},
	{0x3042, 0xf0},
	{0x3042, 0xf0},
	{0x3042, 0xf0},
	{0x3042, 0xf0},
	{0x3042, 0xf0},
	{0x3042, 0xf0},
	{0x3042, 0xf0},
	{0x3042, 0xf0},
	{0x3042, 0xf0},
	{0x3042, 0xf0},
	{0x3042, 0xf0},
	{0x3042, 0xf0},
	{0x3042, 0xf0},
	{0x3042, 0xf0},
	{0x3042, 0xf0},
	{0x3042, 0xf0},
	{0x3042, 0xf0},
	{0x3042, 0xf0},
	{0x3042, 0xf0},
	{0x3042, 0xf0},
	{0x301b, 0xf0},
	{0x301c, 0xf0},
	{0x301a, 0xf0},
	{0xc4bc, 0x01},
	{0xc4bd, 0x60},
	{0xc4a0, 0x03},
	{0xc4a2, 0x04},
	{0x3004, 0x21},
	{0x3702, 0x20},
	{0x3703, 0x48},
	{0x3704, 0x32}
};

const TOV10633RegAddrData atOV10633NOWDRregTbl[OV10633NOWDR_TBL_SIZE] =
{
	{0x0103, 0x01},
	{0x301b, 0xff},
	{0x301c, 0xff},
	{0x301a, 0xff},
	{0x300c, 0x61},
	{0x300c, 0x61},
	{0x300c, 0x61},
	{0x300c, 0x61},
	{0x300c, 0x61},
	{0x300c, 0x61},
	{0x300c, 0x61},
	{0x300c, 0x61},
	{0x300c, 0x61},
	{0x300c, 0x61},
	{0x300c, 0x61},
	{0x300c, 0x61},
	{0x300c, 0x61},
	{0x300c, 0x61},
	{0x300c, 0x61},
	{0x300c, 0x61},
	{0x300c, 0x61},
	{0x300c, 0x61},
	{0x300c, 0x61},
	{0x300c, 0x61},
	{0x300c, 0x61},
	{0x300c, 0x61},
	{0x300c, 0x61},
	{0x3021, 0x03},
	{0x3011, 0x02},
	{0x6900, 0x0c},
	{0x6901, 0x09},
	{0x3033, 0x04},
	{0x3503, 0x10},
	{0x302d, 0x2f},
	{0x3025, 0x03},
	{0x3003, 0x10},
	{0x3004, 0x23},
	{0x3005, 0x20},
	{0x3006, 0x23},
	{0x3600, 0x74},
	{0x3601, 0x2b},
	{0x3612, 0x00},
	{0x3611, 0x67},
	{0x3633, 0xba},
	{0x3602, 0xaf},
	{0x3603, 0x04},
	{0x3630, 0xa8},
	{0x3631, 0x16},
	{0x3714, 0x10},
	{0x371d, 0x01},
	{0x4300, 0x3A},
	{0x3007, 0x01},
	{0x3024, 0x02},
	{0x3020, 0x0a},
	{0x3702, 0x10},
	{0x3703, 0x24},
	{0x3704, 0x19},
	{0x3709, 0x28},
	{0x370d, 0x00},
	{0x3712, 0x00},
	{0x3713, 0x20},
	{0x3715, 0x04},
	{0x381d, 0x00},
	{0x381c, 0x00},
	{0x3824, 0x10},
	{0x3815, 0x8c},
	{0x3804, 0x05},
	{0x3805, 0x1f},
	{0x3800, 0x00},
	{0x3801, 0x00},
	{0x3806, 0x03},
	{0x3807, 0x29},
	{0x3802, 0x00},
	{0x3803, 0x06},
	{0x3808, 0x05},
	{0x3809, 0x00},
	{0x380a, 0x03},
	{0x380b, 0x20},
	{0x380c, 0x07},
	{0x380d, 0x71},
	{0x380e, 0x03},
	{0x380f, 0x48},
	{0x3811, 0x08},
	{0x381f, 0x0c},
	{0x3621, 0x63},
	{0x5005, 0x08},
	{0x56d5, 0x00},
	{0x56d6, 0x80},
	{0x56d7, 0x00},
	{0x56d8, 0x00},
	{0x56d9, 0x00},
	{0x56da, 0x80},
	{0x56db, 0x00},
	{0x56dc, 0x00},
	{0x56e8, 0x00},
	{0x56e9, 0x7f},
	{0x56ea, 0x00},
	{0x56eb, 0x7f},
	{0x5100, 0x00},
	{0x5101, 0x80},
	{0x5102, 0x00},
	{0x5103, 0x80},
	{0x5104, 0x00},
	{0x5105, 0x80},
	{0x5106, 0x00},
	{0x5107, 0x80},
	{0x5108, 0x00},
	{0x5109, 0x00},
	{0x510a, 0x00},
	{0x510b, 0x00},
	{0x510c, 0x00},
	{0x510d, 0x00},
	{0x510e, 0x00},
	{0x510f, 0x00},
	{0x5110, 0x00},
	{0x5111, 0x80},
	{0x5112, 0x00},
	{0x5113, 0x80},
	{0x5114, 0x00},
	{0x5115, 0x80},
	{0x5116, 0x00},
	{0x5117, 0x80},
	{0x5118, 0x00},
	{0x5119, 0x00},
	{0x511a, 0x00},
	{0x511b, 0x00},
	{0x511c, 0x00},
	{0x511d, 0x00},
	{0x511e, 0x00},
	{0x511f, 0x00},
	{0x56d0, 0x00},
	{0x5006, 0x04},
	{0x5608, 0x00},
	{0x52d7, 0x06},
	{0x528d, 0x08},
	{0x5293, 0x12},
	{0x52d3, 0x12},
	{0x5288, 0x06},
	{0x5289, 0x20},
	{0x52c8, 0x06},
	{0x52c9, 0x20},
	{0x52cd, 0x04},
	{0x5381, 0x00},
	{0x5382, 0xff},
	{0x5589, 0x76},
	{0x558a, 0x47},
	{0x558b, 0xef},
	{0x558c, 0xc9},
	{0x558d, 0x49},
	{0x558e, 0x30},
	{0x558f, 0x67},
	{0x5590, 0x3f},
	{0x5591, 0xf0},
	{0x5592, 0x10},
	{0x55a2, 0x6d},
	{0x55a3, 0x55},
	{0x55a4, 0xc3},
	{0x55a5, 0xb5},
	{0x55a6, 0x43},
	{0x55a7, 0x38},
	{0x55a8, 0x5f},
	{0x55a9, 0x4b},
	{0x55aa, 0xf0},
	{0x55ab, 0x10},
	{0x5581, 0x52},
	{0x5300, 0x01},
	{0x5301, 0x00},
	{0x5302, 0x00},
	{0x5303, 0x0e},
	{0x5304, 0x00},
	{0x5305, 0x0e},
	{0x5306, 0x00},
	{0x5307, 0x36},
	{0x5308, 0x00},
	{0x5309, 0xd9},
	{0x530a, 0x00},
	{0x530b, 0x0f},
	{0x530c, 0x00},
	{0x530d, 0x2c},
	{0x530e, 0x00},
	{0x530f, 0x59},
	{0x5310, 0x00},
	{0x5311, 0x7b},
	{0x5312, 0x00},
	{0x5313, 0x22},
	{0x5314, 0x00},
	{0x5315, 0xd5},
	{0x5316, 0x00},
	{0x5317, 0x13},
	{0x5318, 0x00},
	{0x5319, 0x18},
	{0x531a, 0x00},
	{0x531b, 0x26},
	{0x531c, 0x00},
	{0x531d, 0xdc},
	{0x531e, 0x00},
	{0x531f, 0x02},
	{0x5320, 0x00},
	{0x5321, 0x24},
	{0x5322, 0x00},
	{0x5323, 0x56},
	{0x5324, 0x00},
	{0x5325, 0x85},
	{0x5326, 0x00},
	{0x5327, 0x20},
	{0x5609, 0x01},
	{0x560a, 0x40},
	{0x560b, 0x01},
	{0x560c, 0x40},
	{0x560d, 0x00},
	{0x560e, 0xfa},
	{0x560f, 0x00},
	{0x5610, 0xfa},
	{0x5611, 0x02},
	{0x5612, 0x80},
	{0x5613, 0x02},
	{0x5614, 0x80},
	{0x5615, 0x01},
	{0x5616, 0x2c},
	{0x5617, 0x01},
	{0x5618, 0x2c},
	{0x563b, 0x01},
	{0x563c, 0x01},
	{0x563d, 0x01},
	{0x563e, 0x01},
	{0x563f, 0x03},
	{0x5640, 0x03},
	{0x5641, 0x03},
	{0x5642, 0x05},
	{0x5643, 0x09},
	{0x5644, 0x05},
	{0x5645, 0x05},
	{0x5646, 0x05},
	{0x5647, 0x05},
	{0x5651, 0x00},
	{0x5652, 0x80},
	{0x521a, 0x01},
	{0x521b, 0x03},
	{0x521c, 0x06},
	{0x521d, 0x0a},
	{0x521e, 0x0e},
	{0x521f, 0x12},
	{0x5220, 0x16},
	{0x5223, 0x02},
	{0x5225, 0x04},
	{0x5227, 0x08},
	{0x5229, 0x0c},
	{0x522b, 0x12},
	{0x522d, 0x18},
	{0x522f, 0x1e},
	{0x5241, 0x04},
	{0x5242, 0x01},
	{0x5243, 0x03},
	{0x5244, 0x06},
	{0x5245, 0x0a},
	{0x5246, 0x0e},
	{0x5247, 0x12},
	{0x5248, 0x16},
	{0x524a, 0x03},
	{0x524c, 0x04},
	{0x524e, 0x08},
	{0x5250, 0x0c},
	{0x5252, 0x12},
	{0x5254, 0x18},
	{0x5256, 0x1e},
	{0x4605, 0x08},
	{0x4606, 0x07},
	{0x4607, 0x71},
	{0x460a, 0x02},
	{0x460b, 0x70},
	{0x460c, 0x00},
	{0x4620, 0x0e},
	{0x4700, 0x04},
	{0x4701, 0x00},
	{0x4702, 0x01},
	{0x4708, 0x03},
	{0x4004, 0x08},
	{0x4005, 0x18},
	{0x4001, 0x04},
	{0x4050, 0x20},
	{0x4051, 0x22},
	{0x4057, 0x9c},
	{0x405a, 0x00},
	{0x4202, 0x02},
	{0x3023, 0x10},
	{0x0100, 0x01},
	{0x0100, 0x01},
	{0x6f0e, 0x00},
	{0x6f0f, 0x00},
	{0x460e, 0x08},
	{0x460f, 0x01},
	{0x4610, 0x00},
	{0x4611, 0x01},
	{0x4612, 0x00},
	{0x4613, 0x01},
	{0x4605, 0x08},
	{0x4608, 0x00},
	{0x4609, 0x08},
	{0x6804, 0x00},
	{0x6805, 0x06},
	{0x6806, 0x00},
	{0x5120, 0x00},
	{0x3510, 0x00},
	{0x3504, 0x00},
	{0x6800, 0x00},
	{0x6f0d, 0x00},
	{0x5000, 0xff},
	{0x5001, 0xbf},
	{0x5002, 0xfe},
	{0x503d, 0x00},
	{0xc450, 0x01},
	{0xc452, 0x04},
	{0xc453, 0x00},
	{0xc454, 0x00},
	{0xc455, 0x01},
	{0xc456, 0x01},
	{0xc457, 0x00},
	{0xc458, 0x00},
	{0xc459, 0x00},
	{0xc45b, 0x00},
	{0xc45c, 0x01},
	{0xc45d, 0x00},
	{0xc45e, 0x00},
	{0xc45f, 0x00},
	{0xc460, 0x00},
	{0xc461, 0x01},
	{0xc462, 0x01},
	{0xc464, 0x88},
	{0xc465, 0x00},
	{0xc466, 0x8a},
	{0xc467, 0x00},
	{0xc468, 0x86},
	{0xc469, 0x00},
	{0xc46a, 0x40},
	{0xc46b, 0x50},
	{0xc46c, 0x30},
	{0xc46d, 0x28},
	{0xc46e, 0x60},
	{0xc46f, 0x40},
	{0xc47c, 0x01},
	{0xc47d, 0x38},
	{0xc47e, 0x00},
	{0xc47f, 0x00},
	{0xc480, 0x00},
	{0xc481, 0xff},
	{0xc482, 0x00},
	{0xc483, 0x40},
	{0xc484, 0x00},
	{0xc485, 0x18},
	{0xc486, 0x00},
	{0xc487, 0x18},
	{0xc488, 0x34},
	{0xc489, 0x00},
	{0xc48a, 0x34},
	{0xc48b, 0x00},
	{0xc48c, 0x00},
	{0xc48d, 0x04},
	{0xc48e, 0x00},
	{0xc48f, 0x04},
	{0xc490, 0x03},
	{0xc492, 0x20},
	{0xc493, 0x08},
	{0xc498, 0x02},
	{0xc499, 0x00},
	{0xc49a, 0x02},
	{0xc49b, 0x00},
	{0xc49c, 0x02},
	{0xc49d, 0x00},
	{0xc49e, 0x02},
	{0xc49f, 0x60},
	{0xc4a0, 0x04},
	{0xc4a1, 0x00},
	{0xc4a2, 0x06},
	{0xc4a3, 0x00},
	{0xc4a4, 0x00},
	{0xc4a5, 0x10},
	{0xc4a6, 0x00},
	{0xc4a7, 0x40},
	{0xc4a8, 0x00},
	{0xc4a9, 0x80},
	{0xc4aa, 0x0d},
	{0xc4ab, 0x00},
	{0xc4ac, 0x0f},
	{0xc4ad, 0xc0},
	{0xc4b4, 0x01},
	{0xc4b5, 0x01},
	{0xc4b6, 0x00},
	{0xc4b7, 0x01},
	{0xc4b8, 0x00},
	{0xc4b9, 0x01},
	{0xc4ba, 0x01},
	{0xc4bb, 0x00},
	{0xc4be, 0x02},
	{0xc4bf, 0x33},
	{0xc4c8, 0x03},
	{0xc4c9, 0xd0},
	{0xc4ca, 0x0e},
	{0xc4cb, 0x00},
	{0xc4cc, 0x10},
	{0xc4cd, 0x18},
	{0xc4ce, 0x10},
	{0xc4cf, 0x18},
	{0xc4d0, 0x04},
	{0xc4d1, 0x80},
	{0xc4e0, 0x04},
	{0xc4e1, 0x02},
	{0xc4e2, 0x01},
	{0xc4e4, 0x10},
	{0xc4e5, 0x20},
	{0xc4e6, 0x30},
	{0xc4e7, 0x40},
	{0xc4e8, 0x50},
	{0xc4e9, 0x60},
	{0xc4ea, 0x70},
	{0xc4eb, 0x80},
	{0xc4ec, 0x90},
	{0xc4ed, 0xa0},
	{0xc4ee, 0xb0},
	{0xc4ef, 0xc0},
	{0xc4f0, 0xd0},
	{0xc4f1, 0xe0},
	{0xc4f2, 0xf0},
	{0xc4f3, 0x80},
	{0xc4f4, 0x00},
	{0xc4f5, 0x20},
	{0xc4f6, 0x02},
	{0xc4f7, 0x00},
	{0xc4f8, 0x00},
	{0xc4f9, 0x00},
	{0xc4fa, 0x00},
	{0xc4fb, 0x01},
	{0xc4fc, 0x01},
	{0xc4fd, 0x01},
	{0xc4fe, 0x04},
	{0xc4ff, 0x02},
	{0xc500, 0x68},
	{0xc501, 0x74},
	{0xc502, 0x70},
	{0xc503, 0x80},
	{0xc504, 0x05},
	{0xc505, 0x80},
	{0xc506, 0x03},
	{0xc507, 0x80},
	{0xc508, 0x01},
	{0xc509, 0xc0},
	{0xc50a, 0x01},
	{0xc50b, 0xa0},
	{0xc50c, 0x01},
	{0xc50d, 0x2c},
	{0xc50e, 0x01},
	{0xc50f, 0x0a},
	{0xc510, 0x00},
	{0xc511, 0x01},
	{0xc512, 0x01},
	{0xc513, 0x80},
	{0xc514, 0x04},
	{0xc515, 0x00},
	{0xc518, 0x03},
	{0xc519, 0x48},
	{0xc51a, 0x07},
	{0xc51b, 0x70},
	{0xc2e0, 0x00},
	{0xc2e1, 0x51},
	{0xc2e2, 0x00},
	{0xc2e3, 0xd6},
	{0xc2e4, 0x01},
	{0xc2e5, 0x5e},
	{0xc2e9, 0x01},
	{0xc2ea, 0x7a},
	{0xc2eb, 0x90},
	{0xc2ed, 0x00},
	{0xc2ee, 0x7a},
	{0xc2ef, 0x64},
	{0xc308, 0x00},
	{0xc309, 0x00},
	{0xc30a, 0x00},
	{0xc30c, 0x00},
	{0xc30d, 0x01},
	{0xc30e, 0x00},
	{0xc30f, 0x00},
	{0xc310, 0x01},
	{0xc311, 0x60},
	{0xc312, 0xff},
	{0xc313, 0x08},
	{0xc314, 0x01},
	{0xc315, 0x7f},
	{0xc316, 0xff},
	{0xc317, 0x0b},
	{0xc318, 0x00},
	{0xc319, 0x0c},
	{0xc31a, 0x00},
	{0xc31b, 0xe0},
	{0xc31c, 0x00},
	{0xc31d, 0x14},
	{0xc31e, 0x00},
	{0xc31f, 0xc5},
	{0xc320, 0xff},
	{0xc321, 0x4b},
	{0xc322, 0xff},
	{0xc323, 0xf0},
	{0xc324, 0xff},
	{0xc325, 0xe8},
	{0xc326, 0x00},
	{0xc327, 0x46},
	{0xc328, 0xff},
	{0xc329, 0xd2},
	{0xc32a, 0xff},
	{0xc32b, 0xe4},
	{0xc32c, 0xff},
	{0xc32d, 0xbb},
	{0xc32e, 0x00},
	{0xc32f, 0x61},
	{0xc330, 0xff},
	{0xc331, 0xf9},
	{0xc332, 0x00},
	{0xc333, 0xd9},
	{0xc334, 0x00},
	{0xc335, 0x2e},
	{0xc336, 0x00},
	{0xc337, 0xb1},
	{0xc338, 0xff},
	{0xc339, 0x64},
	{0xc33a, 0xff},
	{0xc33b, 0xeb},
	{0xc33c, 0xff},
	{0xc33d, 0xe8},
	{0xc33e, 0x00},
	{0xc33f, 0x48},
	{0xc340, 0xff},
	{0xc341, 0xd0},
	{0xc342, 0xff},
	{0xc343, 0xed},
	{0xc344, 0xff},
	{0xc345, 0xad},
	{0xc346, 0x00},
	{0xc347, 0x66},
	{0xc348, 0x01},
	{0xc349, 0x00},
	{0x6700, 0x08},
	{0x6701, 0x11},
	{0x6702, 0xfc},
	{0x6703, 0x9a},
	{0x6704, 0x3b},
	{0x6705, 0x65},
	{0x6706, 0x71},
	{0x6708, 0x05},
	{0x3822, 0x50},
	{0x6f06, 0x6f},
	{0x6f07, 0x00},
	{0x6f0a, 0x6f},
	{0x6f0b, 0x00},
	{0x6f00, 0x03},
	{0x3042, 0xf0},
	{0x3042, 0xf0},
	{0x3042, 0xf0},
	{0x3042, 0xf0},
	{0x3042, 0xf0},
	{0x3042, 0xf0},
	{0x3042, 0xf0},
	{0x3042, 0xf0},
	{0x3042, 0xf0},
	{0x3042, 0xf0},
	{0x3042, 0xf0},
	{0x3042, 0xf0},
	{0x3042, 0xf0},
	{0x3042, 0xf0},
	{0x3042, 0xf0},
	{0x3042, 0xf0},
	{0x3042, 0xf0},
	{0x3042, 0xf0},
	{0x3042, 0xf0},
	{0x3042, 0xf0},
	{0x3042, 0xf0},
	{0x3042, 0xf0},
	{0x3042, 0xf0},
	{0x3042, 0xf0},
	{0x3042, 0xf0},
	{0x3042, 0xf0},
	{0xc261, 0x01},
	{0x301b, 0xf0},
	{0x301c, 0xf0},
	{0x301a, 0xf0},
	{0x3004, 0x21},
	{0x3006, 0x21},
	{0x3702, 0x20},
	{0x3703, 0x48},
	{0x3704, 0x32}
};

/*-------------------------------------------------------------------------------------*/
const int aiRGB2YUVX1000[4][3] = 
{   
	{114,	587,		299},
	{500,	-331,	-169},
	{-56,	287,		-222},
	{-81,	-419,	500},
};
/*-------------------------------------------------------------------------------------*/
EOV10633Regs aeOV10633TargetReg[3] = 
{
	_C46A_TargetLong1,
	_C46D_TargetShort1,
	_C464_LogTarget11
};
const BYTE abyOV10633TargetData[3][5] =
{
	//-2         -1         0            +1          +2
	{0x20,	0x40,	0x40,	0x60,	0x70},
	{0x18,	0x28,	0x28,	0x38,	0x40},
	{0x38,	0x68,	0x88,	0xb0,	0xd8},
};
/*-------------------------------------------------------------------------------------*/
EOV10633Regs aeOV10633ContrastReg[15] = 
{
	_C4E4_ContrastCurve1,
	_C4E5_ContrastCurve2,
	_C4E6_ContrastCurve3,
	_C4E7_ContrastCurve4,
	_C4E8_ContrastCurve5,
	_C4E9_ContrastCurve6,
	_C4EA_ContrastCurve7,
	_C4EB_ContrastCurve8,
	_C4EC_ContrastCurve9,
	_C4ED_ContrastCurve10,
	_C4EE_ContrastCurve11,
	_C4EF_ContrastCurve12,
	_C4F0_ContrastCurve13,
	_C4F1_ContrastCurve14,
	_C4F2_ContrastCurve15
};
const BYTE abyOV10633ContrastData[15][5] =
{
	//-2         -1         0            +1          +2
	{0x01,	0x03,	0x06,	0x10,	0x1A},
	{0x05,	0x0a,	0x10,	0x20,	0x2D},
	{0x0b,	0x14,	0x1d,	0x30,	0x3D},
	{0x16,	0x22,	0x2d,	0x40,	0x4C},
	{0x29,	0x34,	0x3f,	0x50,	0x5A},
	{0x42,	0x4c,	0x53,	0x60,	0x67},
	{0x5F,	0x64,	0x69,	0x70,	0x73},
	{0x80,	0x80,	0x80,	0x80,	0x80},
	{0x9F,	0x99,	0x96,	0x90,	0x8D},
	{0xC0,	0xB3,	0xac,	0xa0,	0x9A},
	{0xD8,	0xCa,	0xc0,	0xb0,	0xA8},
	{0xE8,	0xDd,	0xd2,	0xc0,	0xB7},
	{0xF6,	0xEB,	0xe2,	0xd0,	0xC7},
	{0xFC,	0xF6,	0xef,	0xe0,	0xD8},
	{0xFF,	0xFD,	0xf9,	0xf0,	0xEB},
};
/*-------------------------------------------------------------------------------------*/
EOV10633Regs aeOV10633WDRReg[3] = 
{
	0xc4b1	,
	0xc4b2	,
	0xc4b3	
};
const BYTE abyOV10633WDRData[3][9] =
{	 //+0DB                  													+48DB
	{0x01,	0x02,	0x02,	0x02,	0x02,	0x02,	0x02,	0x02,	0x02},
	{0x00,	0x00,	0x00,	0x00,	0x00,	0x00,	0x00,	0x00,	0x01},
	{0x01,	0x02,	0x04,	0x08,	0x10,	0x20,	0x40,	0x80,	0x00},
};
/*-------------------------------------------------------------------------------------*/
EOV10633Regs aeOV10633SaturationReg[36] = 
{
	0xC31e	,
	0xC31f	,
	0xC320	,
	0xC321	,
	0xC322	,
	0xC323	,
	0xC324	,
	0xC325	,
	0xC326	,
	0xC327	,
	0xC328	,
	0xC329	,
	0xC32a	,
	0xC32b	,
	0xC32c	,
	0xC32d	,
	0xC32e	,
	0xC32f	,
	0xC336	,
	0xC337	,
	0xC338	,
	0xC339	,
	0xC33a	,
	0xC33b	,
	0xC33c	,
	0xC33d	,
	0xC33e	,
	0xC33f	,
	0xC340	,
	0xC341	,
	0xC342	,
	0xC343	,
	0xC344	,
	0xC345	,
	0xC346	,
	0xC347	
};
const BYTE abyOV10633SaturationData[36][7] =
{
	{0x0,	0x0,		0x0,		0x0,		0x0,		0x0,		0x1},
	{0x0,	0x2A,	0x55,	0x80,	0xAB,	0xd6,	0x1},
	{0x0,	0xFF,	0xFF,	0xFF,	0xFF,	0xff,	0xFF},
	{0x0,	0xD8,	0xB1,	0x8A,	0x63,	0x3c,	0x15},
	{0x0,	0xFF,	0xFF,	0xFF,	0xFF,	0xff,	0xFF},
	{0x0,	0xFE,	0xFA,	0xF6,	0xF2,	0xee,	0xEA},
	{0x0,	0xFF,	0xFF,	0xFF,	0xFF,	0xff,	0xFF},
	{0x0,	0xFD,	0xF8,	0xF3,	0xEE,	0xe9,	0xE4},
	{0x0,	0x0,		0x0,		0x0,		0x0,		0x0,		0x0},
	{0x0,	0x10,	0x1F,	0x2E,	0x3D,	0x4c,	0x5B},
	{0x0,	0xFF,	0xFF,	0xFF,	0xFF,	0xff,	0xFF},
	{0x0,	0xF7,	0xEC,	0xE1,	0xD6,	0xcb,	0xC0},
	{0x0,	0xFF,	0xFF,	0xFF,	0xFF,	0xff,	0xFF},
	{0x0,	0xF6,	0xF0,	0xEA,	0xE4,	0xdd,	0xD6},
	{0x0,	0xFF,	0xFF,	0xFF,	0xFF,	0xff,	0xFF},
	{0x0,	0xF1,	0xE2,	0xD3,	0xC4,	0xb5,	0xA6},
	{0x0,	0x0,		0x0,		0x0,		0x0,		0x0,		0x0},
	{0x0,	0x16,	0x2C,	0x42,	0x58,	0x6e,	0x84},
	{0x0,	0x0,		0x0,		0x0,		0x0,		0x0,		0x0},
	{0x0,	0x26,	0x4D,	0x74,	0x9B,	0xc2,	0xE9},
	{0x0,	0xFF,	0xFF,	0xFF,	0xFF,	0xff,	0xFF},
	{0x0,	0xDC,	0xBA,	0x98,	0x76,	0x54,	0x32},
	{0x0,	0xFF,	0xFF,	0xFF,	0xFF,	0xff,	0xFF},
	{0x0,	0xFA,	0xF6,	0xF2,	0xEE,	0xea,	0xE6},
	{0x0,	0xFF,	0xFF,	0xFF,	0xFF,	0xff,	0xFF},
	{0x0,	0xFC,	0xF7,	0xF2,	0xED,	0xe8,	0xE3},
	{0x0,	0x0,		0x0,		0x0,		0x0,		0x0,		0x0},
	{0x0,	0x0E,	0x1E,	0x2E,	0x3E,	0x4e,	0x5E},
	{0x0,	0xFF,	0xFF,	0xFF,	0xFF,	0xff,	0xFF},
	{0x0,	0xF6,	0xEB,	0xE0,	0xD5,	0xca,	0xBF},
	{0x0,	0xFF,	0xFF,	0xFF,	0xFF,	0xff,	0xFF},
	{0x0,	0xF9,	0xF4,	0xEF,	0xEA,	0xe5,	0xE0},
	{0x0,	0xFF,	0xFF,	0xFF,	0xFF,	0xff,	0xFF},
	{0x0,	0xF0,	0xDE,	0xCC,	0xBA,	0xa8,	0x96},
	{0x0,	0x0,		0x0,		0x0,		0x0,		0x0,		0x0},
	{0x0,	0x17,	0x2E,	0x45,	0x5C,	0x73,	0x8A},
};
/*-------------------------------------------------------------------------------------*/
EOV10633Regs aeOV10633SharpnessReg[60] = 
{
	0x521a	,
	0x521b	,
	0x521c	,
	0x521d	,
	0x521e	,
	0x521f	,
	0x5220	,
	0x5222	,
	0x5223	,
	0x5224	,
	0x5225	,
	0x5226	,
	0x5227	,
	0x5228	,
	0x5229	,
	0x522a	,
	0x522b	,
	0x522c	,
	0x522d	,
	0x522e	,
	0x522f	,
	0x5242	,
	0x5243	,
	0x5244	,
	0x5245	,
	0x5246	,
	0x5247	,
	0x5248	,
	0x5249	,
	0x524a	,
	0x524b	,
	0x524c	,
	0x524d	,
	0x524e	,
	0x524f	,
	0x5250	,
	0x5251	,
	0x5252	,
	0x5253	,
	0x5254	,
	0x5255	,
	0x5256	,
	0x5288	,
	0x5289	,
	0x528c	,
	0x528d	,
	0x528e	,
	0x528f	,
	0x5290	,
	0x5291	,
	0x5293	,
	0x52c8	,
	0x52c9	,
	0x52cc	,
	0x52cd	,
	0x52ce	,
	0x52cf	,
	0x52d0	,
	0x52d1	,
	0x52d3	
};
const BYTE abyOV10633SharpnessData[60][5] =
{
	{0x6,	0x4,		0x1,		0x1,		0x1},
	{0x8,	0x6,		0x2,		0x2,		0x2},
	{0x0a,	0x8,		0x6,		0x6,		0x6},
	{0x0c,	0x0a,	0x0a,	0x0a,	0x0a},
	{0x0e,	0x0e,	0x0e,	0x0e,	0x0e},
	{0x12,	0x12,	0x12,	0x12,	0x12},
	{0x16,	0x16,	0x16,	0x16,	0x16},
	{0x0,	0x0,		0x0,		0x0,		0x0},
	{0x6,	0x4,		0x2,		0x2,		0x2},
	{0x0,	0x0,		0x0,		0x0,		0x0},
	{0x8,	0x6,		0x4,		0x4,		0x4},
	{0x0,	0x0,		0x0,		0x0,		0x0},
	{0x0a,	0x8,		0x8,		0x8,		0x8},
	{0x0,	0x0,		0x0,		0x0,		0x0},
	{0x0c,	0x0c,	0x0c,	0x0c,	0x0c},
	{0x0,	0x0,		0x0,		0x0,		0x0},
	{0x12,	0x12,	0x12,	0x12,	0x12},
	{0x0,	0x0,		0x0,		0x0,		0x0},
	{0x18,	0x18,	0x18,	0x18,	0x18},
	{0x0,	0x0,		0x0,		0x0,		0x0},
	{0x1e,	0x1e,	0x1e,	0x1e,	0x1e},
	{0x6,	0x4,		0x1,		0x1,		0x1},
	{0x8,	0x6,		0x3,		0x3,		0x3},
	{0x0a,	0x8,		0x6,		0x6,		0x6},
	{0x0c,	0x0a,	0x0a,	0x0a,	0x0a},
	{0x0e,	0x0e,	0x0e,	0x0e,	0x0e},
	{0x12,	0x12,	0x12,	0x12,	0x12},
	{0x16,	0x16,	0x16,	0x16,	0x16},
	{0x0,	0x0,		0x0,		0x0,		0x0},
	{0x6,	0x4,		0x3,		0x3,		0x3},
	{0x0,	0x0,		0x0,		0x0,		0x0},
	{0x8,	0x6,		0x4,		0x4,		0x4},
	{0x0,	0x0,		0x0,		0x0,		0x0},
	{0x0a,	0x8,		0x8,		0x8,		0x8},
	{0x0,	0x0,		0x0,		0x0,		0x0},
	{0x0c,	0x0c,	0x0c,	0x0c,	0x0c},
	{0x0,	0x0,		0x0,		0x0,		0x0},
	{0x12,	0x12,	0x12,	0x12,	0x12},
	{0x0,	0x0,		0x0,		0x0,		0x0},
	{0x18,	0x18,	0x18,	0x18,	0x18},
	{0x0,	0x0,		0x0,		0x0,		0x0},
	{0x1e,	0x1e,	0x1e,	0x1e,	0x1e},
	{0x10,	0x10,	0x6,		0x6,		0x4},
	{0x30,	0x30,	0x20,	0x20,	0x18},
	{0x0,	0x0,		0x0,		0x6,		0x0a},
	{0x0,	0x2,		0x8,		0x0a,	0x14},
	{0x10,	0x10,	0x10,	0x0c,	0x0c},
	{0x60,	0x60,	0x60,	0x50,	0x50},
	{0x20,	0x20,	0x20,	0x18,	0x18},
	{0x60,	0x60,	0x60,	0x50,	0x50},
	{0x10,	0x10,	0x12,	0x1f,	0x1f},
	{0x10,	0x10,	0x6,		0x10,	0x0c},
	{0x30,	0x30,	0x20,	0x30,	0x20},
	{0x0,	0x0,		0x0,		0x1,		0x3},
	{0x0,	0x0,		0x4,		0x3,		0x6},
	{0x10,	0x10,	0x10,	0x0c,	0x0c},
	{0x60,	0x60,	0x60,	0x50,	0x50},
	{0x20,	0x20,	0x20,	0x18,	0x18},
	{0x60,	0x60,	0x60,	0x50,	0x50},
	{0x10,	0x10,	0x12,	0x1f,	0x1f},
};

/*==================================================================*/
static int OV10633_WriteBuf(TOV10633Info *ptInfo, EOV10633Regs eRegAddr, BYTE byData)
{
	BYTE abyData[2];

	abyData[0] = (BYTE)(eRegAddr&0xFF);
	abyData[1] = byData;
	return ptInfo->pfnWriteBuf(ptInfo->dwFuncUserData, (ptInfo->dwDeviceAddr&0xFF), ((eRegAddr&0xFF00)>>8), 2, abyData);
}

/*-------------------------------------------------------------------------------------*/ 
static int OV10633_ReadBuf(TOV10633Info *ptInfo, EOV10633Regs eRegAddr, BYTE *pbyData)
{
	*pbyData = (BYTE)(eRegAddr&0xFF);
	return ptInfo->pfnReadBuf(ptInfo->dwFuncUserData, ptInfo->dwDeviceAddr, ((eRegAddr&0xFF00)>>8), 1, pbyData);	
}
 
/*-------------------------------------------------------------------------------------*/
static int OV10633_CompBuf(TOV10633Info *ptInfo, EOV10633Regs eRegAddr, BYTE byMask, BYTE byData)
{
	BYTE byReadData;

	OV10633_ReadBuf(ptInfo, eRegAddr, &byReadData);
	return ((byReadData&byMask) == byData);
}

/*-------------------------------------------------------------------------------------*/
#if 0
static int OV10633_UpdateBuf(TOV10633Info *ptInfo, EOV10633Regs eRegAddr, BYTE byMask, BYTE byData)
{
	BYTE byReadData, byWriteData;

	if (OV10633_ReadBuf(ptInfo, eRegAddr, &byReadData) < 0)
	{
		return -1;
	}
	byWriteData = ((byReadData&byMask) | byData);
	if (OV10633_WriteBuf(ptInfo, eRegAddr, byWriteData) < 0)
	{
		return -1;
	}
	return 0;
}
#endif

/*-------------------------------------------------------------------------------------*/
static void OV10633_Reset(TOV10633Info *ptInfo)
{
	DWORD dwIndex = 0;

	if(ptInfo->bOV10633WDREnable)
	{
		for (dwIndex=0; dwIndex<OV10633WDR_TBL_SIZE; dwIndex++)
		{
			OV10633_WriteBuf(ptInfo, atOV10633WDRregTbl[dwIndex].eRegAddr, atOV10633WDRregTbl[dwIndex].byData);
		}
	}
	else
	{
		for (dwIndex=0; dwIndex<OV10633NOWDR_TBL_SIZE; dwIndex++)
		{
			OV10633_WriteBuf(ptInfo, atOV10633NOWDRregTbl[dwIndex].eRegAddr, atOV10633NOWDRregTbl[dwIndex].byData);
		}

	}
	//Set OB
	OV10633_WriteBuf(ptInfo, 0x4008, 0x05);
	OV10633_WriteBuf(ptInfo, 0x4009, 0x05);

	return;
}

/*-------------------------------------------------------------------------------------*/
void OV10633_SetShutter(DWORD dwShutter)
{
}

/*-------------------------------------------------------------------------------------*/
void OV10633_SetGain(DWORD dwGain)
{
}

/*-------------------------------------------------------------------------------------*/
int  OV10633_Ioctl(TVideoSignalOptions* ptIoctlArg, DWORD dwDevNum)
{
	int ret = 0, i, j, aiCoeff[3][3], iTmp;
/* Version 1.0.0.1 modification, 2012.08.06 */
	DWORD *dwWindowAddr, dwData0=0, dwData1=0, adwAEWindow[4]={0};
/* ======================================== */
	//DWORD dwData2=0;

	if (down_interruptible(&OV10633_mutex))
	{
		return -ERESTARTSYS;	
	}
	switch (ptIoctlArg->eOptionFlags)
	{
		case VIDEO_SIGNAL_OPTION_RESET:
		OV10633_Reset(ptInfo);
		break;
		case VIDEO_SIGNAL_OPTION_SET_SHUTTER_CTRL:
		OV10633_SetShutter(ptIoctlArg->adwUserData[0]);
		break;
		case VIDEO_SIGNAL_OPTION_SET_GLOBALGAIN_CTRL:
		OV10633_SetGain(ptIoctlArg->adwUserData[0]);
		break;
#if 1
		case VIDEO_SIGNAL_OPTION_SET_FREQUENCY:
		if (ptIoctlArg->adwUserData[0] == VIDEO_SIGNAL_FREQUENCY_60HZ)
		{
			ptInfo->dwFreq	= VIDEO_SIGNAL_FREQUENCY_60HZ;
			dwData0 = 0x01;
		}
		else
		{
			ptInfo->dwFreq = VIDEO_SIGNAL_FREQUENCY_50HZ;
			dwData0 = 0x02;
		}
		OV10633_WriteBuf(ptInfo, _6F00_GroupWriterCommand, 0xc3);
		OV10633_WriteBuf(ptInfo, _C45E_BandFilterFlag, (BYTE)(dwData0&0xFF));
		OV10633_WriteBuf(ptInfo, _C45F_BandFilterEn, 0x61);
		OV10633_WriteBuf(ptInfo, _C460_BandFilterShort, 0x01);
		OV10633_WriteBuf(ptInfo, _6F00_GroupWriterCommand, 0x03);
		OV10633_WriteBuf(ptInfo, _6F00_GroupWriterCommand, 0x43);
		break;
		case VIDEO_SIGNAL_OPTION_SET_AUTO_EXPOSURE_TARGET_LUMINANCE:
/*
		dwData0 = (ptIoctlArg->adwUserData[0]>255) ? 255 : (ptIoctlArg->adwUserData[0]<0) ? 0 : ptIoctlArg->adwUserData[0];
		dwData1 = (ptIoctlArg->adwUserData[1]>255) ? 255 : (ptIoctlArg->adwUserData[1]<0) ? 0 : ptIoctlArg->adwUserData[1];
*/
#if 0
		dwData0 = (ptIoctlArg->adwUserData[0]*3) / 2;
		dwData1 = ptIoctlArg->adwUserData[0] / 3;

		dwData0 = (dwData0>255) ? 255 : (dwData0<0) ? 0 : dwData0;
		dwData1 = (dwData1>255) ? 255 : (dwData1<0) ? 0 : dwData1;

		dwData2 = dwData0 + dwData1;
		dwData2 = (dwData2>255) ? 255 : (dwData2<0) ? 0 : dwData2;
	
		OV10633_WriteBuf(ptInfo, _6F00_GroupWriterCommand, 0xc3);

		OV10633_WriteBuf(ptInfo, _C46A_TargetLong1, dwData0);
		OV10633_WriteBuf(ptInfo, _C46D_TargetShort1, dwData1);
		OV10633_WriteBuf(ptInfo, _C464_LogTarget11, dwData2);
		OV10633_WriteBuf(ptInfo, _C465_LogTarget12, 0x00);
/*
		OV10633_WriteBuf(ptInfo, 0xc472, dwData1);
		OV10633_WriteBuf(ptInfo, 0xc473, dwData1);
		OV10633_WriteBuf(ptInfo, _56A0_AECCTRLA0, dwData1);
		OV10633_WriteBuf(ptInfo, _56A1_AECCTRLA1, dwData1);
*/
		OV10633_WriteBuf(ptInfo, _6F00_GroupWriterCommand, 0x03);
		OV10633_WriteBuf(ptInfo, _6F00_GroupWriterCommand, 0x43);
#else
		dwData0 = ptIoctlArg->adwUserData[0] + 1;
		dwData0 /= 64 ;
		dwData0 = (dwData0>4) ? 4 : (dwData0<0) ? 0 : dwData0;

		OV10633_WriteBuf(ptInfo, _6F00_GroupWriterCommand, 0xc3);
		for (i=0; i<3; i++)
		{
			OV10633_WriteBuf(ptInfo, aeOV10633TargetReg[i], abyOV10633TargetData[i][dwData0]);
		}
		OV10633_WriteBuf(ptInfo, _6F00_GroupWriterCommand, 0x03);
		OV10633_WriteBuf(ptInfo, _6F00_GroupWriterCommand, 0x43);
#endif
		break;
		case VIDEO_SIGNAL_OPTION_SET_AUTO_EXPOSURE_WINDOWS:
/* Version 1.0.0.1 modification, 2012.08.06 */
		case VIDEO_SIGNAL_OPTION_SET_AUTO_EXPOSURE_MODE:
/* ======================================== */
		dwWindowAddr = (DWORD *)(ptIoctlArg->adwUserData[0]);
/* Version 1.0.0.1 modification, 2012.08.06 */
		for (i=0; i<2; i++)
/* ======================================== */
		{
			if ((i%2) == 0)
			{
				adwAEWindow[(2*i)+1] = (((*dwWindowAddr)-1)>>16) - 1;
				adwAEWindow[2*i] = (*dwWindowAddr) - ((adwAEWindow[(2*i)+1]+1)<<16) - 1;
			}else
			{
				adwAEWindow[2*i+1] = ((*dwWindowAddr) >> 16);
				adwAEWindow[2*i] = (*dwWindowAddr) - ((adwAEWindow[(2*i)+1])<<16);
			}
			dwWindowAddr++;
		}
		adwAEWindow[1] = adwAEWindow[1] - 2;

		OV10633_WriteBuf(ptInfo, _6F00_GroupWriterCommand, 0xc3);
#if 0
		//Out 4 Zone
		OV10633_WriteBuf(ptInfo, 0x5601, (BYTE)((adwAEWindow[0]>>8)&0x07));
		OV10633_WriteBuf(ptInfo, 0x5602, (BYTE)(adwAEWindow[0]&0xFF));
		OV10633_WriteBuf(ptInfo, 0x5603, (BYTE)((adwAEWindow[1]>>8)&0x03));
		OV10633_WriteBuf(ptInfo, 0x5604, (BYTE)(adwAEWindow[1]&0xFF));
		OV10633_WriteBuf(ptInfo, 0x5605, (BYTE)(((adwAEWindow[0]+adwAEWindow[2])>>8)&0x07));
		OV10633_WriteBuf(ptInfo, 0x5606, (BYTE)((adwAEWindow[0]+adwAEWindow[2])&0xFF));
		OV10633_WriteBuf(ptInfo, 0x5607, (BYTE)(((adwAEWindow[1]+adwAEWindow[3])>>8)&0x03));
		OV10633_WriteBuf(ptInfo, 0x5608, (BYTE)((adwAEWindow[1]+adwAEWindow[3])&0xFF));
		//Long inner 9 Zone
		OV10633_WriteBuf(ptInfo, _5609_AECCTRL09, (BYTE)(((adwAEWindow[0]+adwAEWindow[2]/5)>>8)&0x07));
		OV10633_WriteBuf(ptInfo, _560A_AECCTRL0A, (BYTE)((adwAEWindow[0]+(adwAEWindow[2]/5))&0xFF));
		OV10633_WriteBuf(ptInfo, _560D_AECCTRL0D, (BYTE)(((adwAEWindow[1]+(adwAEWindow[3]/5))>>8)&0x03));
		OV10633_WriteBuf(ptInfo, _560E_AECCTRL0E, (BYTE)((adwAEWindow[1]+(adwAEWindow[3]/5))&0xFF));
		OV10633_WriteBuf(ptInfo, _5611_AECCTRL11, (BYTE)((((adwAEWindow[2]*3)/5)>>8)&0x07));
		OV10633_WriteBuf(ptInfo, _5612_AECCTRL12, (BYTE)(((adwAEWindow[2]*3)/5)&0xFF));
		OV10633_WriteBuf(ptInfo, _5615_AECCTRL15, (BYTE)((((adwAEWindow[3]*3)/5)>>8)&0x03));
		OV10633_WriteBuf(ptInfo, _5616_AECCTRL16, (BYTE)(((adwAEWindow[3]*3)/5)&0xFF));
		//Short inner 9 Zone
		OV10633_WriteBuf(ptInfo, _560B_AECCTRL0B, (BYTE)(((adwAEWindow[0]+(adwAEWindow[2]/5))>>8)&0x07));
		OV10633_WriteBuf(ptInfo, _560C_AECCTRL0C, (BYTE)((adwAEWindow[0]+(adwAEWindow[2]/5))&0xFF));
		OV10633_WriteBuf(ptInfo, _560F_AECCTRL0F, (BYTE)(((adwAEWindow[1]+(adwAEWindow[3]/5))>>8)&0x03));
		OV10633_WriteBuf(ptInfo, _5610_AECCTRL10, (BYTE)((adwAEWindow[1]+(adwAEWindow[3]/5))&0xFF));
		OV10633_WriteBuf(ptInfo, _5613_AECCTRL13, (BYTE)((((adwAEWindow[2]*3)/5)>>8)&0x07));
		OV10633_WriteBuf(ptInfo, _5614_AECCTRL14, (BYTE)(((adwAEWindow[2]*3)/5)&0xFF));
		OV10633_WriteBuf(ptInfo, _5617_AECCTRL17, (BYTE)((((adwAEWindow[3]*3)/5)>>8)&0x03));
		OV10633_WriteBuf(ptInfo, _5618_AECCTRL18, (BYTE)(((adwAEWindow[3]*3)/5)&0xFF));
#else
		OV10633_WriteBuf(ptInfo, _5609_AECCTRL09, (BYTE)((adwAEWindow[0]>>8)&0x07));
		OV10633_WriteBuf(ptInfo, _560A_AECCTRL0A, (BYTE)(adwAEWindow[0]&0xFF));
		OV10633_WriteBuf(ptInfo, _560D_AECCTRL0D, (BYTE)((adwAEWindow[1]>>8)&0x03));
		OV10633_WriteBuf(ptInfo, _560E_AECCTRL0E, (BYTE)(adwAEWindow[1]&0xFF));
		OV10633_WriteBuf(ptInfo, _5611_AECCTRL11, (BYTE)((adwAEWindow[2]>>8)&0x07));
		OV10633_WriteBuf(ptInfo, _5612_AECCTRL12, (BYTE)(adwAEWindow[2]&0xFF));
		OV10633_WriteBuf(ptInfo, _5615_AECCTRL15, (BYTE)((adwAEWindow[3]>>8)&0x03));
		OV10633_WriteBuf(ptInfo, _5616_AECCTRL16, (BYTE)(adwAEWindow[3]&0xFF));

		OV10633_WriteBuf(ptInfo, _560B_AECCTRL0B, (BYTE)((adwAEWindow[0]>>8)&0x07));
		OV10633_WriteBuf(ptInfo, _560C_AECCTRL0C, (BYTE)(adwAEWindow[0]&0xFF));
		OV10633_WriteBuf(ptInfo, _560F_AECCTRL0F, (BYTE)((adwAEWindow[1]>>8)&0x03));
		OV10633_WriteBuf(ptInfo, _5610_AECCTRL10, (BYTE)(adwAEWindow[1]&0xFF));
		OV10633_WriteBuf(ptInfo, _5613_AECCTRL13, (BYTE)((adwAEWindow[2]>>8)&0x07));
		OV10633_WriteBuf(ptInfo, _5614_AECCTRL14, (BYTE)(adwAEWindow[2]&0xFF));
		OV10633_WriteBuf(ptInfo, _5617_AECCTRL17, (BYTE)((adwAEWindow[3]>>8)&0x03));
		OV10633_WriteBuf(ptInfo, _5618_AECCTRL18, (BYTE)(adwAEWindow[3]&0xFF));

#endif
		OV10633_WriteBuf(ptInfo, _6F00_GroupWriterCommand, 0x03);
		OV10633_WriteBuf(ptInfo, _6F00_GroupWriterCommand, 0x43);
		break;
		case VIDEO_SIGNAL_OPTION_SET_AUTO_EXPOSURE_WINDOW_PRIORITY:
		OV10633_WriteBuf(ptInfo, _6F00_GroupWriterCommand, 0xc3);
		//ROI
		OV10633_WriteBuf(ptInfo, _562A_AECCTRL2A, 0x1);
		OV10633_WriteBuf(ptInfo, _562B_AECCTRL2B, 0x1);
		OV10633_WriteBuf(ptInfo, _562C_AECCTRL2C, 0x1);
		OV10633_WriteBuf(ptInfo, _562D_AECCTRL2D, 0x1);
#if 0
		//Long inner 13 Zone
		OV10633_WriteBuf(ptInfo, _562E_AECCTRL2E, 0x1);
		OV10633_WriteBuf(ptInfo, _562F_AECCTRL2F, 0x1);
		OV10633_WriteBuf(ptInfo, _5630_AECCTRL30, 0x1);
		OV10633_WriteBuf(ptInfo, _5631_AECCTRL31, 0x1);
		OV10633_WriteBuf(ptInfo, _5632_AECCTRL32, 0x1);
		OV10633_WriteBuf(ptInfo, _5633_AECCTRL33, 0x1);
		OV10633_WriteBuf(ptInfo, _5634_AECCTRL34, 0x1);
		OV10633_WriteBuf(ptInfo, _5635_AECCTRL35, 0x1);
		OV10633_WriteBuf(ptInfo, _5636_AECCTRL36, 0x1);
		OV10633_WriteBuf(ptInfo, _5637_AECCTRL37, 0x1);
		OV10633_WriteBuf(ptInfo, _5638_AECCTRL38, 0x1);
		OV10633_WriteBuf(ptInfo, _5639_AECCTRL39, 0x1);
		OV10633_WriteBuf(ptInfo, _563A_AECCTRL3A, 0x1);

		//Short inner 13 Zone
		OV10633_WriteBuf(ptInfo, _563B_AECCTRL3B, 0x1);
		OV10633_WriteBuf(ptInfo, _563C_AECCTRL3C, 0x1);
		OV10633_WriteBuf(ptInfo, _563D_AECCTRL3D, 0x1);
		OV10633_WriteBuf(ptInfo, _563E_AECCTRL3E, 0x1);
		OV10633_WriteBuf(ptInfo, _563F_AECCTRL3F, 0x1);
		OV10633_WriteBuf(ptInfo, _5640_AECCTRL40, 0x1);
		OV10633_WriteBuf(ptInfo, _5641_AECCTRL41, 0x1);
		OV10633_WriteBuf(ptInfo, _5642_AECCTRL42, 0x1);
		OV10633_WriteBuf(ptInfo, _5643_AECCTRL43, 0x1);
		OV10633_WriteBuf(ptInfo, _5644_AECCTRL44, 0x1);
		OV10633_WriteBuf(ptInfo, _5645_AECCTRL45, 0x1);
		OV10633_WriteBuf(ptInfo, _5646_AECCTRL46, 0x1);
		OV10633_WriteBuf(ptInfo, _5647_AECCTRL47, 0x1);

#else
		//Long inner 13 Zone
		OV10633_WriteBuf(ptInfo, _562E_AECCTRL2E, 0x1);
		OV10633_WriteBuf(ptInfo, _562F_AECCTRL2F, 0x1);
		OV10633_WriteBuf(ptInfo, _5630_AECCTRL30, 0x1);
		OV10633_WriteBuf(ptInfo, _5631_AECCTRL31, 0x1);
		OV10633_WriteBuf(ptInfo, _5632_AECCTRL32, 0x3);
		OV10633_WriteBuf(ptInfo, _5633_AECCTRL33, 0x3);
		OV10633_WriteBuf(ptInfo, _5634_AECCTRL34, 0x3);
		OV10633_WriteBuf(ptInfo, _5635_AECCTRL35, 0x5);
		OV10633_WriteBuf(ptInfo, _5636_AECCTRL36, 0x9);
		OV10633_WriteBuf(ptInfo, _5637_AECCTRL37, 0x5);
		OV10633_WriteBuf(ptInfo, _5638_AECCTRL38, 0x5);
		OV10633_WriteBuf(ptInfo, _5639_AECCTRL39, 0x5);
		OV10633_WriteBuf(ptInfo, _563A_AECCTRL3A, 0x5);
		//Short inner 13 Zone
		OV10633_WriteBuf(ptInfo, _563B_AECCTRL3B, 0x1);
		OV10633_WriteBuf(ptInfo, _563C_AECCTRL3C, 0x1);
		OV10633_WriteBuf(ptInfo, _563D_AECCTRL3D, 0x1);
		OV10633_WriteBuf(ptInfo, _563E_AECCTRL3E, 0x1);
		OV10633_WriteBuf(ptInfo, _563F_AECCTRL3F, 0x3);
		OV10633_WriteBuf(ptInfo, _5640_AECCTRL40, 0x3);
		OV10633_WriteBuf(ptInfo, _5641_AECCTRL41, 0x3);
		OV10633_WriteBuf(ptInfo, _5642_AECCTRL42, 0x5);
		OV10633_WriteBuf(ptInfo, _5643_AECCTRL43, 0x9);
		OV10633_WriteBuf(ptInfo, _5644_AECCTRL44, 0x5);
		OV10633_WriteBuf(ptInfo, _5645_AECCTRL45, 0x5);
		OV10633_WriteBuf(ptInfo, _5646_AECCTRL46, 0x5);
		OV10633_WriteBuf(ptInfo, _5647_AECCTRL47, 0x5);
#endif
		OV10633_WriteBuf(ptInfo, _6F00_GroupWriterCommand, 0x03);
		OV10633_WriteBuf(ptInfo, _6F00_GroupWriterCommand, 0x43);
		break;
		case VIDEO_SIGNAL_OPTION_SET_AUTO_EXPOSURE_MIN_SHUTTER:
		if (ptIoctlArg->adwUserData[0] > 120)
		{
			dwData0 = 0x01;
		}
		else
		{
			dwData0 = 0x00;
		}
		OV10633_WriteBuf(ptInfo, _6F00_GroupWriterCommand, 0xc3);
		OV10633_WriteBuf(ptInfo, _C461_Less1BandEn, dwData0);
		OV10633_WriteBuf(ptInfo, _C462_Less1BandShort, dwData0);
		OV10633_WriteBuf(ptInfo, _6F00_GroupWriterCommand, 0x03);
		OV10633_WriteBuf(ptInfo, _6F00_GroupWriterCommand, 0x43);
		break;
		case VIDEO_SIGNAL_OPTION_SET_AUTO_EXPOSURE_MAX_SHUTTER:
		switch (ptIoctlArg->adwUserData[0])
		{
			case 1:
			dwData0 = 0xEE;
			dwData1 = 0x20;
			break;
			case 2:
			dwData0 = 0x77;
			dwData1 = 0x10;
			break;
			case 4:
			dwData0 = 0x3B;
			dwData1 = 0x88;
			break;
			case 8:
			dwData0 = 0x1D;
			dwData1 = 0xC4;
			break;
			case 15:
			case 25:
			dwData0 = 0x0E;
			dwData1 = 0xE2;
			break;
			default:
			dwData0 = 0x07;
			dwData1 = 0x71;
			break;
		}

		//OV10633_WriteBuf(ptInfo, _6F00_GroupWriterCommand, 0xc3);

		OV10633_WriteBuf(ptInfo, _380C_TimingHTS1, dwData0);
		OV10633_WriteBuf(ptInfo, _380D_TimingHTS0, dwData1);
		OV10633_WriteBuf(ptInfo, _380E_TimingVTS1, 0x03);
		OV10633_WriteBuf(ptInfo, _380F_TimingVTS0, 0x48);

		//OV10633_WriteBuf(ptInfo, _6F00_GroupWriterCommand, 0x03);
		//OV10633_WriteBuf(ptInfo, _6F00_GroupWriterCommand, 0x43);
		break;
	case VIDEO_SIGNAL_OPTION_SET_AUTO_EXPOSURE_MAX_GAIN:
/* Version 1.0.0.3 modification, 2013.05.02 */
		if (ptIoctlArg->adwUserData[0] == 2000)
		{
			dwData0 = 0x001F;
		}
		else if (ptIoctlArg->adwUserData[0] == 4000)
		{
			dwData0 = 0x003F;
		}
		else if (ptIoctlArg->adwUserData[0] == 8000)
		{
			dwData0 = 0x007F;
		}
		else if (ptIoctlArg->adwUserData[0] == 16000)
		{
			dwData0 = 0x00FF;
		}
		else if (ptIoctlArg->adwUserData[0] == 32000)
/* ======================================== */
		{
			dwData0 = 0x01FF;
		}
		else
		{ // (ptIoctlArg->adwUserData[0] == 64)
			dwData0 = 0x03FF;
		}
		OV10633_WriteBuf(ptInfo, _6F00_GroupWriterCommand, 0xc3);
		OV10633_WriteBuf(ptInfo, _C480_MaxGainLong1, (BYTE)((dwData0>>8)&0xFF));
		OV10633_WriteBuf(ptInfo, _C481_MaxGainLong0, (BYTE)(dwData0&0xFF));
		OV10633_WriteBuf(ptInfo, _6F00_GroupWriterCommand, 0x03);
		OV10633_WriteBuf(ptInfo, _6F00_GroupWriterCommand, 0x43);
		break;
	case VIDEO_SIGNAL_OPTION_SET_WDR:
		if (ptIoctlArg->adwUserData[0] >= 1)
		{
			dwData0 = (ptIoctlArg->adwUserData[0]>=8) ? 8 : ptIoctlArg->adwUserData[0];
			for (i=0; i<OV10633WDR_TBL_SIZE; i++)
			{
				OV10633_WriteBuf(ptInfo, atOV10633WDRregTbl[i].eRegAddr, atOV10633WDRregTbl[i].byData);
			}
			OV10633_WriteBuf(ptInfo, _6F00_GroupWriterCommand, 0xc3);
			OV10633_WriteBuf(ptInfo, _C454_NonWDREn, 0x00);
			for (i=0; i<3; i++)
			{
				OV10633_WriteBuf(ptInfo, aeOV10633WDRReg[i], abyOV10633WDRData[i][dwData0]);
			}
			OV10633_WriteBuf(ptInfo, _6F00_GroupWriterCommand, 0x03);
			OV10633_WriteBuf(ptInfo, _6F00_GroupWriterCommand, 0x43);
			ptInfo->bOV10633WDREnable = TRUE;
		}
		else
		{
			for (i=0; i<OV10633NOWDR_TBL_SIZE; i++)
			{
				OV10633_WriteBuf(ptInfo, atOV10633NOWDRregTbl[i].eRegAddr, atOV10633NOWDRregTbl[i].byData);
			}
			ptInfo->bOV10633WDREnable = FALSE;
		}
		break;
/*
		case VIDEO_SIGNAL_OPTION_SET_SATURATION:
		dwData0 = (ptIoctlArg->adwUserData[1]*10) / 425;
		dwData0 = (dwData0>6) ? 6 : (dwData0<0) ? 0 : dwData0;

		OV10633_WriteBuf(ptInfo, _6F00_GroupWriterCommand, 0xc3);
		for (i=0; i<36; i++)
		{
			OV10633_WriteBuf(ptInfo, aeOV10633SaturationReg[i], abyOV10633SaturationData[i][dwData0]);
		}
		OV10633_WriteBuf(ptInfo, _6F00_GroupWriterCommand, 0x03);
		OV10633_WriteBuf(ptInfo, _6F00_GroupWriterCommand, 0x43);
		break;
	case VIDEO_SIGNAL_OPTION_SET_SHARPNESS:
		dwData0 = (ptIoctlArg->adwUserData[1]*10) / 425;
		dwData0 = (dwData0>6) ? 6 : (dwData0<0) ? 0 : dwData0;

		OV10633_WriteBuf(ptInfo, _6F00_GroupWriterCommand, 0xc3);

		for (i=0; i<60; i++)
		{
			OV10633_WriteBuf(ptInfo, aeOV10633SharpnessReg[i], abyOV10633SharpnessData[i][dwData0]);
		}

		OV10633_WriteBuf(ptInfo, _6F00_GroupWriterCommand, 0x03);
		OV10633_WriteBuf(ptInfo, _6F00_GroupWriterCommand, 0x43);
		break;

		case VIDEO_SIGNAL_OPTION_SET_CONTRAST:
		dwData0 = ptIoctlArg->adwUserData[0] + 129;
		if (dwData0 > 256)
		{
			dwData0 -= 256;
		}
		dwData0 /= 64 ;
		dwData0 = (dwData0>4) ? 4 : (dwData0<0) ? 0 : dwData0;

		OV10633_WriteBuf(ptInfo, _6F00_GroupWriterCommand, 0xc3);
		for (i=0; i<15; i++)
		{
			OV10633_WriteBuf(ptInfo, aeOV10633ContrastReg[i], abyOV10633ContrastData[i][dwData0]);
		}
		OV10633_WriteBuf(ptInfo, _6F00_GroupWriterCommand, 0x03);
		OV10633_WriteBuf(ptInfo, _6F00_GroupWriterCommand, 0x43);
		break;
		case VIDEO_SIGNAL_OPTION_SET_FLIP:
		OV10633_WriteBuf(ptInfo, _6F00_GroupWriterCommand, 0xc3);
		if (ptIoctlArg->adwUserData[0] == 1)
		{
			OV10633_WriteBuf(ptInfo, _381C_TimingCTRL1C, 0xC0);
		}
		else
		{
			OV10633_WriteBuf(ptInfo, _381C_TimingCTRL1C, 0x00);
		}
		OV10633_WriteBuf(ptInfo, _6F00_GroupWriterCommand, 0x03);
		OV10633_WriteBuf(ptInfo, _6F00_GroupWriterCommand, 0x43);
		break;
		case VIDEO_SIGNAL_OPTION_SET_MIRROR:
		OV10633_WriteBuf(ptInfo, _6F00_GroupWriterCommand, 0xc3);
		if (ptIoctlArg->adwUserData[0] == 1)
		{
			OV10633_WriteBuf(ptInfo, _381D_TimingCTRL1D, 0x43);
		}
		else
		{
			OV10633_WriteBuf(ptInfo, _381D_TimingCTRL1D, 0x40);
		}
		OV10633_WriteBuf(ptInfo, _6F00_GroupWriterCommand, 0x03);
		OV10633_WriteBuf(ptInfo, _6F00_GroupWriterCommand, 0x43);
		break;
*/
		case VIDEO_SIGNAL_OPTION_SET_COLOR_CORRECTION:
/* Version 1.0.0.1 modification, 2011.2.16 */
		aiCoeff[2][2] = (ptIoctlArg->adwUserData[0]&0x8000000) ? 
					-((ptIoctlArg->adwUserData[0]>>18)&0x1FF) :
					((ptIoctlArg->adwUserData[0]>>18)&0x1FF);
		aiCoeff[2][1] = (ptIoctlArg->adwUserData[0]&0x2000) ?
					-((ptIoctlArg->adwUserData[0]>>9)&0xFF) :
					((ptIoctlArg->adwUserData[0]>>9)&0xFF);
		aiCoeff[2][0] = (ptIoctlArg->adwUserData[0]&0x100) ?
					-(ptIoctlArg->adwUserData[0]&0xFF) :
					(ptIoctlArg->adwUserData[0]&0xFF);
		aiCoeff[1][2] = (ptIoctlArg->adwUserData[1]&0x8000000) ?
					-((ptIoctlArg->adwUserData[1]>>19)&0xFF) :
					((ptIoctlArg->adwUserData[1]>>19)&0xFF);
		aiCoeff[1][1] = (ptIoctlArg->adwUserData[1]&0x40000) ?
					-((ptIoctlArg->adwUserData[1]>>9)&0x1FF) :
					((ptIoctlArg->adwUserData[1]>>9)&0x1FF);
		aiCoeff[1][0] = (ptIoctlArg->adwUserData[1]&0x100) ?
					-(ptIoctlArg->adwUserData[1]&0xFF) :
					(ptIoctlArg->adwUserData[1]&0xFF);
		aiCoeff[0][2] = (ptIoctlArg->adwUserData[2]&0x8000000) ?
					-((ptIoctlArg->adwUserData[2]>>19)&0xFF) :
					((ptIoctlArg->adwUserData[2]>>19)&0xFF);
		aiCoeff[0][1] = (ptIoctlArg->adwUserData[2]&0x40000) ?
					-((ptIoctlArg->adwUserData[2]>>10)&0xFF) :
					((ptIoctlArg->adwUserData[2]>>10)&0xFF);
		aiCoeff[0][0] = (ptIoctlArg->adwUserData[2]&0x200) ?
					-(ptIoctlArg->adwUserData[2]&0x1FF) :
					(ptIoctlArg->adwUserData[2]&0x1FF);
		dwData0 = 0xC318;//Long 
		//dwData1 = 0xC330;//Short

		OV10633_WriteBuf(ptInfo, _6F00_GroupWriterCommand, 0xc3);
		for (i=0; i<4; i++)
		{
			for (j=0; j<3; j++)
			{
				iTmp = ((2*((aiRGB2YUVX1000[i][0] * aiCoeff[0][j])+(aiRGB2YUVX1000[i][1] * aiCoeff[1][j])+(aiRGB2YUVX1000[i][2] * aiCoeff[2][j])))+500) / 1000;
				if (iTmp <= 0)	
				{
					iTmp += 65536;
				}
				OV10633_WriteBuf(ptInfo, dwData0, ((iTmp>>8)&0xFF));
				OV10633_WriteBuf(ptInfo, (dwData0+1), (iTmp&0xFF));
				dwData0 += 2;
/*
				OV10633_WriteBuf(ptInfo, dwData1, ((iTmp>>8)&0xFF));
				OV10633_WriteBuf(ptInfo, dwData1+1, (iTmp&0xFF));
				dwData1 += 2;
*/
			}
		}
		OV10633_WriteBuf(ptInfo, _6F00_GroupWriterCommand, 0x03);
		OV10633_WriteBuf(ptInfo, _6F00_GroupWriterCommand, 0x43);
		break;
/*	
		case VIDEO_SIGNAL_OPTION_SET_GAMMA_TABLE:
		break;
		case VIDEO_SIGNAL_OPTION_SET_TONE_MAPPING:
		break;
		case VIDEO_SIGNAL_OPTION_SET_PHOTO_LDC_EN:
		break;
		case VIDEO_SIGNAL_OPTION_SET_AUTO_WHITE_BALANCE_CTRL:
		break;		
*/
#endif
		default:
		ret = -EPERM;
	}
	up(&OV10633_mutex);	

	return ret;
}

/*-------------------------------------------------------------------------------------*/
void OV10633_Release(DWORD dwDevNum)
{
	IICCtrl_Release((void*)(&(ptInfo->dwFuncUserData)));
	kfree(ptInfo);
}

/*-------------------------------------------------------------------------------------*/
int OV10633_Open(TVideoSensorInitialParam* ptOV10633InitialParam, DWORD dwDevNum)
{
	TIICCtrlInitOptions tIICCtrlInitOptions;
	void* hIICCtrlObject;

	if (((ptOV10633InitialParam->dwVideoSensorVersion&0x00FF00FF)!=(OV10633_INTERFACE_VERSION&0x00FF00FF)) ||
		((ptOV10633InitialParam->dwVideoSensorVersion&0x0000FF00)>(OV10633_INTERFACE_VERSION&0x0000FF00)))
	{
		printk("Invalid OV10633 device driver version %d.%d.%d.%d !!\n", 
				(int)(OV10633_INTERFACE_VERSION&0xFF), 
				(int)((OV10633_INTERFACE_VERSION>>8)&0xFF), 
				(int)((OV10633_INTERFACE_VERSION>>16)&0xFF), 
				(int)(OV10633_INTERFACE_VERSION>>24)&0xFF);
		return S_INVALID_VERSION;
	}

	if (!(ptInfo = (TOV10633Info *)kmalloc(sizeof(TOV10633Info), GFP_KERNEL)))
	{
		printk("[OV10633] : Allocate %d bytes memory fail\n", sizeof(TOV10633Info));
		return -ENOMEM;
	}

	// init iic
	tIICCtrlInitOptions.dwTransType = IICCTRL_TYPE_ADDR_16_BITS_DATA;
	tIICCtrlInitOptions.dwMaxDataLength = 8;
	tIICCtrlInitOptions.dwBusNum = 0;
	if (IICCtrl_Initial(&hIICCtrlObject, &tIICCtrlInitOptions))
	{
		printk("[OV10633] : Initial IICCtrl object fail !!\n");
		OV10633_Release(dwDevNum);				
		return -ENODEV;
	}
	
	// init private data
	ptInfo->dwDeviceAddr = OV10633_DEAFULT_DEVICE_ADDR;
	ptInfo->dwFuncUserData = (DWORD)hIICCtrlObject;
	ptInfo->pfnReadBuf = (FOnReadBuf)IICCtrl_ReadBuf;
	ptInfo->pfnWriteBuf = (FOnWriteBuf)IICCtrl_WriteBuf;
	ptInfo->dwFreq = (DWORD)(ptOV10633InitialParam->dwVideoSensorFrequency);
	ptInfo->bOV10633WDREnable = TRUE;

	ptInfo->eFormat = VIDEO_SIGNAL_FORMAT_PROGRESSIVE_RAW;

	// Detect device
	if (!OV10633_CompBuf(ptInfo, _300A_PID, 0xFF, ((OV10633_PID>>8)&0xFF)))
	{
		printk("[OV10633] : device doesn't exist in device address 0x%02lX\n", ptInfo->dwDeviceAddr);
		OV10633_Release(dwDevNum);	
		return -ENODEV;
	}
	if (!OV10633_CompBuf(ptInfo, _300B_VER, 0xFF, (OV10633_PID&0xFF)))
	{
		printk("[OV10633] : device doesn't exist in device address 0x%02lX\n", ptInfo->dwDeviceAddr);
		OV10633_Release(dwDevNum);	
		return -ENODEV;
	}

	// Reset device
	OV10633_Reset(ptInfo);

	return 0;
}

/*-------------------------------------------------------------------------------------*/
TVideoSensorDevice sensor_dev_ops =
{
	.open = 	OV10633_Open,
	.release = 	OV10633_Release,
	.ioctl = 	OV10633_Ioctl,
	.get_shutter_value = NULL,
	.get_remaining_line_num = NULL,
	.group_access = NULL,
/* Version 1.0.0.1 modification, 2012.08.06 */
	.get_exp_statistic = NULL,
	.get_wb_statistic = NULL,
	.get_max_gain = NULL,
/* ======================================== */
};
EXPORT_SYMBOL(sensor_dev_ops);

/*==================================================================*/
typedef struct OV10633_attribute
{
	struct attribute attr;
	ssize_t (*show)(struct kobject *kobj, char *buf);
} TOV10633Attribute;

/**
 * Sysfs subsystem: forward read calls
 *
 * Sysfs operation for forwarding read call to the show method of the
 * attribute owner
 */
ssize_t OV10633_default_attr_show(struct kobject *kobj, struct attribute *attr, char *buf)
{
	TOV10633Attribute *OV10633_attr = container_of(attr, TOV10633Attribute, attr);
	int result = 0;
	
	if (OV10633_attr->show)
	{
		result = OV10633_attr->show(kobj, buf);	
	}
	return result;
}

ssize_t OV10633_SensorName_attr_show(struct kobject *kobj, char *buf)
{
	int retval;
	retval = sprintf (buf, "%s\n", "OV10633");
	return retval;
}

ssize_t OV10633_dwBufNum_attr_show(struct kobject *kobj, char *buf)
{
	int retval;
	retval = sprintf (buf, "%s\n", "5");
	return retval;
}

ssize_t OV10633_MaxFrameWidth_attr_show(struct kobject *kobj, char *buf)
{
	int retval;
	retval = sprintf (buf, "%s\n", "1280");
	return retval;
}

ssize_t OV10633_MaxFrameHeight_attr_show(struct kobject *kobj, char *buf)
{
	int retval;
	retval = sprintf (buf, "%s\n", "800");
	return retval;
}
/*-------------------------------------------------------------------------------------*/
struct kobject OV10633_kobj;

TOV10633Attribute OV10633_SensorName_attr =
{
	.attr = {
		.name = "SensorName",
		.mode = S_IRUGO | S_IWUSR,
	},
	.show = OV10633_SensorName_attr_show,
};

TOV10633Attribute OV10633_dwBufNum_attr =
{
	.attr = {
		.name = "dwBufNum",
		.mode = S_IRUGO | S_IWUSR,
	},
	.show = OV10633_dwBufNum_attr_show,
};

TOV10633Attribute OV10633_MaxFrameWidth_attr =
{
	.attr = {
		.name = "MaxFrameWidth",
		.mode = S_IRUGO | S_IWUSR,
	},
	.show = OV10633_MaxFrameWidth_attr_show,
};

TOV10633Attribute OV10633_MaxFrameHeight_attr =
{
	.attr = {
		.name = "MaxFrameHeight",
		.mode = S_IRUGO | S_IWUSR,
	},
	.show = OV10633_MaxFrameHeight_attr_show,
};

struct sysfs_ops OV10633_sysfs_ops =
{
	.show	= OV10633_default_attr_show,
};

struct kobj_type OV10633_ktype =
{
	.sysfs_ops	= &OV10633_sysfs_ops,
};

/*-------------------------------------------------------------------------------------*/
static int OV10633_Init(void)
{
	int result = 0;
	
	if (result < 0)
	{
		printk("[OV10633] : kobj set name fail!\n");
		return -1;
	}

	OV10633_kobj.ktype = &OV10633_ktype;	
	result = kobject_init_and_add(&OV10633_kobj, &OV10633_ktype, NULL, "VideoSensorInfo");

	if (result < 0)
	{
		printk("[OV10633] : Cannot register kobject [OV10633_kobj].\n");
		return -1;
	}

	result = sysfs_create_file(&OV10633_kobj, &OV10633_SensorName_attr.attr);		
	if (result < 0)
	{
		printk("[OV10633] : Cannot create OV10633_SensorName_attr.attr.\n");
		return -1;
	}

	result = sysfs_create_file(&OV10633_kobj, &OV10633_dwBufNum_attr.attr);		
	if (result < 0)
	{
		printk("[OV10633] : Cannot create OV10633_dwBufNum_attr.attr.\n");
		return -1;
	}

	result = sysfs_create_file(&OV10633_kobj, &OV10633_MaxFrameWidth_attr.attr);		
	if (result < 0)
	{
		printk("[OV10633] : Cannot create OV10633_MaxFrameWidth_attr.attr.\n");
		return -1;
	}

	result = sysfs_create_file(&OV10633_kobj, &OV10633_MaxFrameHeight_attr.attr);		
	if (result < 0)
	{
		printk("[OV10633] : Cannot create OV10633_MaxFrameHeight_attr.attr.\n");
		return -1;
	}	   
	sema_init(&OV10633_mutex, 1);
		
	return 0;
}

/*-------------------------------------------------------------------------------------*/
static void OV10633_Exit(void)
{
	sysfs_remove_file(&OV10633_kobj, &(OV10633_SensorName_attr.attr));
	sysfs_remove_file(&OV10633_kobj, &(OV10633_dwBufNum_attr.attr));	
	sysfs_remove_file(&OV10633_kobj, &(OV10633_MaxFrameWidth_attr.attr));	
	sysfs_remove_file(&OV10633_kobj, &(OV10633_MaxFrameHeight_attr.attr));		
	kobject_put(&OV10633_kobj);	
	printk(KERN_DEBUG"[OV10633] : bye\n");
	return;
}

/*-------------------------------------------------------------------------------------*/
module_init(OV10633_Init);
module_exit(OV10633_Exit);
